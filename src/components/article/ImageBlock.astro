---
import { Image } from "astro:assets";
import type { ArcContentElement } from "../../services/articleService";

interface Props {
  element: ArcContentElement;
}

const { element } = Astro.props;

// Check for image URL in various possible locations in the ARCXP API response
const imageUrl =
  element.url ||
  element.promo_items?.basic?.url ||
  element.additional_properties?.original?.url ||
  element.additional_properties?.url ||
  "";

if (!imageUrl) {
  return null;
}

// Get caption from various possible locations in the element
const caption =
  element.caption ||
  element.subtitle ||
  element.additional_properties?.caption ||
  element.additional_properties?.original?.caption ||
  element.promo_items?.basic?.caption ||
  "";
---

<div class="image-block mb-8">
  {
    imageUrl && (
      <div>
        <Image
          src={imageUrl}
          alt={caption || "Article image"}
          width={800}
          height={450}
          format="webp"
          quality={80}
          class="w-full rounded-lg"
        />
        {caption && (
          <div class="text-sm text-gray-500 mt-2 italic">{caption}</div>
        )}
      </div>
    )
  }
</div>
